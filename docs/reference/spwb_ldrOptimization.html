<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Optimization of root distribution — spwb_ldrOptimization • medfate</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Optimization of root distribution — spwb_ldrOptimization" />

<meta property="og:description" content="The function spwb_ldrOptimization optimizes the species root distribution within spwb, given the arguments x, meteo, soil and psi_crit. The optimization is based on the eco-hydrological equilibrium hypothesis (Eagleson, 1982), which is formulated here as the root distribution for which plant transpiration is maximized while the plant water potential is close to the species-defined critical value psi_crit (Cabon et al.,2018). Returns the optimized root distribution for each species, expressed as parameters of the function root_ldrDistribution." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/AdvancedWaterEnergyBalance.html">2. Advanced water and energy balance simulation</a>
    </li>
    <li>
      <a href="../articles/ForestGrowth.html">3. Forest growth simulation</a>
    </li>
    <li>
      <a href="../articles/PackageOverview.html">Package overview</a>
    </li>
    <li>
      <a href="../articles/SimpleWaterBalance.html">1. Introduction to water balance simulation</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Optimization of root distribution</h1>
    
    <div class="hidden name"><code>spwb_ldrOptimization.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The function <code>spwb_ldrOptimization</code> optimizes the species root distribution within <code>spwb</code>, given the arguments <code>x</code>, <code>meteo</code>, <code>soil</code> and <code>psi_crit</code>. The optimization is based on the eco-hydrological equilibrium hypothesis (Eagleson, 1982), which is formulated here as the root distribution for which plant transpiration is maximized while the plant water potential is close to the species-defined critical value <code>psi_crit</code> (Cabon et al.,2018). Returns the optimized root distribution for each species, expressed as parameters of the function <code>root_ldrDistribution</code>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>spwb_ldrOptimization</span>(<span class='no'>x</span>, <span class='no'>soil</span>, <span class='no'>meteo</span>, <span class='no'>psi_crit</span>, <span class='kw'>opt_mode</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>RZmin</span> <span class='kw'>=</span> <span class='fl'>301</span>, <span class='kw'>RZmax</span> <span class='kw'>=</span> <span class='fl'>4000</span>,
                    <span class='kw'>V1min</span> <span class='kw'>=</span> <span class='fl'>0.01</span>, <span class='kw'>V1max</span> <span class='kw'>=</span> <span class='fl'>0.94</span>, <span class='kw'>resolution</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>heat_stop</span> <span class='kw'>=</span> <span class='fl'>0</span>,
                    <span class='kw'>transformation</span> <span class='kw'>=</span> <span class='st'>"identity"</span>, <span class='kw'>explore_out</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
                    <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class <code><a href='forest2spwbInput.html'>spwbInput</a></code>.</p></td>
    </tr>
    <tr>
      <th>soil</th>
      <td><p>A list containing the description of the soil (see <code><a href='soil.html'>soil</a></code>).</p></td>
    </tr>
    <tr>
      <th>meteo</th>
      <td><p>A data frame with daily meteorological data series. When using the 'Granier' transpiration mode the following columns are required:</p><ul>
<li><p><code>DOY</code>: Day of the year (Julian day).</p></li>
<li><p><code>Precipitation</code>: Precipitation (in mm).</p></li>
<li><p><code>MeanTemperature</code>: Mean temperature (in degrees Celsius).</p></li>
<li><p><code>PET</code>: Potential evapotranspiration (in mm).</p></li>
</ul><p></p></td>
    </tr>
    <tr>
      <th>psi_crit</th>
      <td><p>A numerical vector of length iqual to the number of species in the plot containing the species values of water potential inducing hydraulic failure (in MPa). Use <code>NA</code> values to skip optimization for particular plant cohorts.</p></td>
    </tr>
    <tr>
      <th>opt_mode</th>
      <td><p>Optimization mode:</p><ul>
<li><p><code>opt_mode = 1</code> maximizes transpiration along the line of stress equal to <code>psi_crit</code> (Cabon et al. 2018).</p></li>
<li><p><code>opt_mode = 2</code> maximizes transpiration, subject to root construction constrains, among combinations with  stress according to <code>psi_crit</code>).</p></li>
</ul><p></p></td>
    </tr>
    <tr>
      <th>RZmin</th>
      <td><p>The minimum value of RZ (the rooting depth) to be explored (in mm)</p></td>
    </tr>
    <tr>
      <th>RZmax</th>
      <td><p>The maximum value of RZ (the rooting depth) to be explored (in mm)</p></td>
    </tr>
    <tr>
      <th>V1min</th>
      <td><p>The minimum value of V1 (the root proportion in the first soil layer) to be explored</p></td>
    </tr>
    <tr>
      <th>V1max</th>
      <td><p>The maximum value of V1 (the root proportion in the first soil layer) to be explored</p></td>
    </tr>
    <tr>
      <th>resolution</th>
      <td><p>An integer defining the number of values to obtain by discretization of the root parameters RZ and V1. The number of parameter combinations and therefore the computation cost increases increase with the square of resolution</p></td>
    </tr>
    <tr>
      <th>transformation</th>
      <td><p>Function to modify the size of Z intervals to be explored (by default, bins are equal).</p></td>
    </tr>
    <tr>
      <th>heat_stop</th>
      <td><p>An integer defining the number of days during to discard from the calculation of the optimal root distribution. Usefull if the soil water content initialization is not certain</p></td>
    </tr>
    <tr>
      <th>explore_out</th>
      <td><p>A logical value. Are the values of average daily plant transpiration and minimum plant water potential to be returned?</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>A logical value. Print the internal messages of the function?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters to function <code><a href='spwb.html'>spwb</a></code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For each combination of the parameters RZ and V1 the function runs <code>spwb</code>, setting the total soil depth equal to RZ. The root proportion in each soil layer is derived from V1, the depth of the first soil layer (as defined in the argument <code>soil</code>) and RZ using the LDR root distribution model (Schenk and Jackson, 2002) and assuming that the depth containing 95 percent of the roots is equal to RZ. <code>psi_crit</code>, the species specific water potential inducing hydraulic failure, can be approached by the water potential inducing 50 percent of loss of conductance for the and gymnosperms and 88 percent for the angiosperms (Urli et al., 2013, Brodribb et al., 2010). Details of the hypothesis and limitations of the optimization method are given in Cabon et al. (under review).</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>explore_out = FALSE</code> returns a data frame with containing the species index used in medfate, <code>psi_crit</code> and the otpimized values of V1 and the LDR parameters Z50 and Z95 (see <code><a href='root.html'>root_ldrDistribution</a></code>) and as many rows as the number of species. If <code>explore_out = TRUE</code> returns a list containing <code>optim</code>, the aforementioned data frame, and <code>explore_out</code>, a list containing two array with the values of average daily plant transpiration and the minimum plant water potential for each species and parameter combination.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Brodribb, T.J., Bowman, D.J.M.S., Nichols, S., Delzon, S., Burlett, R., 2010. Xylem function and growth rate interact to determine recovery rates after exposure to extreme water deficit. New Phytol. 188, 533–542. doi:10.1111/j.1469-8137.2010.03393.x</p>
<p>Cabon, A., Martínez-Vilalta, J., Poyatos, R., Martínez de Aragón, J., De Cáceres, M. (2018) Applying the eco-hydrological equilibrium hypothesis to estimate root ditribution in water-limited forests. Ecohydrology 11: e2015.</p>
<p>Eagleson, P.S., 1982. Ecological optimality in water-limited natural soil-vegetation systems: 1. Theory and hypothesis. Water Resour. Res. 18, 325–340. doi:10.1029/WR018i002p00325</p>
<p>Schenk, H.J., Jackson, R.B., 2002. The Global Biogeography of Roots. Ecol. Monogr. 72, 311. doi:10.2307/3100092</p>
<p>Urli, M., Porte, A.J., Cochard, H., Guengant, Y., Burlett, R., Delzon, S., 2013. Xylem embolism threshold for catastrophic hydraulic failure in angiosperm trees. Tree Physiol. 33, 672–683. doi:10.1093/treephys/tpt030</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='spwb.html'>spwb</a></code>, <code><a href='soil.html'>soil</a></code>, <code><a href='root.html'>root_ldrDistribution</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'>#Load example daily meteorological data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>examplemeteo</span>)

<span class='co'>#Load example plot plant data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>exampleforest</span>)

<span class='co'>#Default species parameterization</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>SpParamsMED</span>)

<span class='co'>#Initialize soil with default soil params</span>
<span class='no'>examplesoil</span> <span class='kw'>=</span> <span class='fu'><a href='soil.html'>soil</a></span>(<span class='fu'><a href='defaultSoilParams.html'>defaultSoilParams</a></span>(<span class='fl'>2</span>))

<span class='co'>#Initialize control parameters</span>
<span class='no'>control</span> <span class='kw'>=</span> <span class='fu'><a href='defaultControl.html'>defaultControl</a></span>()

<span class='co'>#Initialize input</span>
<span class='no'>x</span> <span class='kw'>=</span> <span class='fu'><a href='forest2spwbInput.html'>forest2spwbInput</a></span>(<span class='no'>exampleforest</span>,<span class='no'>examplesoil</span>, <span class='no'>SpParamsMED</span>, <span class='no'>control</span>)

<span class='co'>#Run optimization</span>
<span class='fu'>spwb_ldrOptimization</span>(<span class='kw'>x</span> <span class='kw'>=</span> <span class='no'>x</span>, <span class='kw'>soil</span> <span class='kw'>=</span> <span class='no'>examplesoil</span>, <span class='kw'>meteo</span> <span class='kw'>=</span> <span class='no'>examplemeteo</span>,
                     <span class='kw'>psi_crit</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(-<span class='fl'>2</span>,-<span class='fl'>3</span>,-<span class='fl'>4</span>), <span class='kw'>elevation</span> <span class='kw'>=</span> <span class='fl'>100</span>)
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Antoine Cabon, CTFC</p>
<p>Miquel De Cáceres Ainsa, CTFC</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Miquel De Cáceres, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

