[
["model-inputs.html", "Chapter 2 Model inputs 2.1 Soil description 2.2 Vegetation description 2.3 Metereological input 2.4 Control parameters", " Chapter 2 Model inputs Data input for process-based models of forest functioning and dynamics can be described using three broad categories. First, a description of the target vegetation is needed, at a level of detail appropriate for the model design. This includes not only species composition and/or structure, but also functional parameters of the plants. Second, most often soil information is required, specially if underground resources (i.e. water and/or nutrients) are important for the processes included in the model. While soil and vegetation features are sometimes considered static parameters in model simulations, meteorology is most often a dynamic input which defines the temporal variation of environmental conditions in which biological processes occur. This chapter describes the requirements of medfate package with respect to each of these three kinds of input. The last section describes additional parameters that are used to control the behaviour of simulation functions. 2.1 Soil description Soils can be described in medfate using between 1 and 5 soil layers. The number and size of layers may reflect changes in soil properties, but also can be chosen to reflect different plant rooting depths. The physical properties of the soil are needed to estimate its hydraulic properties. Most soil properties are considered static parameters in simulations, except those that depend on soil water balance (e.g. soil moisture content, soil water potential and soil conductivity) and soil temperature, if the soil energy balance is considered in simulations. 2.1.1 Physical properties Physical soil properties, like soil texture (i.e. percent of sand, silt and clay), bulk density or rock fragment content, can differ between soil layers, and this has important consequences for water retention capacity and soil hydraulics. In addition, specifying a deep rocky layer may be important in some biomes like the Mediterranean one, because plants often extend their roots into cracks existing in the parent rock (Ruffault et al. 2013). For each soil layer \\(s\\) the following physical parameters are needed: Symbol Units R Description \\(d_{s}\\) \\(mm\\) widths Soil layer width \\(P_{clay,s}\\) % clay Percent of clay (within soil particles) \\(P_{sand,s}\\) % sand Percent of sand (within soil particles) \\(OM\\) % om Percentage of organic mater per dry weight (can be missing) \\(BD_{s}\\) \\(g \\cdot cm^{-3}\\) bd Bulk density \\(P_{rocks,s}\\) % rfc Rock fragment content as percent per soil volume Soil depth is defined as the sum of soil layer widths. If possible, soil physical properties should be measured in soil profiles conducted at the target forest plot. Soil input data should be arranged in a data.frame with soil layers in rows and physical variables in columns (see function defaultSoilParams()). The package includes function soilgridsParams() to fetch soil information from SoilGrids.org, a global soil database currently providing soil data at 250m scale. This can be helpful to users lacking local soil measurements, but the uncertainty of SoilGrids estimates can be high for some areas and soil properties, especially soil depth and rock fragment content. 2.1.2 Water retention curves The water retention curve of a soil is the relationship between volumetric soil moisture (\\(\\theta\\), in \\(m^3 \\cdot m^{-3}\\) of soil, excluding rock fragments) and the soil water potential (\\(\\Psi\\), in MPa). This curve is characteristic for different types of soil, and is also called the soil moisture characteristic curve. Two water retention curve models are available in medfate: Saxton model: In this model, volumetric soil moisture \\(\\theta(\\Psi)\\) corresponding to a given water potential \\(\\Psi\\) (in MPa) below \\(\\Psi_{fc}\\) is calculated using: \\[\\begin{equation}\\theta(\\Psi) = (\\Psi/A)^{(1/B)}\\end{equation}\\] where \\(A\\) and \\(B\\) depend on the texture and, if available, organic matter in the soil. If organic matter is available, \\(A\\) and \\(B\\) are calculated from \\(P_{clay}\\), \\(P_{sand}\\) and \\(OM\\) following K. E. Saxton and Rawls (2006). Otherwise, they are calculated from \\(P_{clay}\\) and \\(P_{sand}\\) as indicated in K. Saxton et al. (1986). Volumetric changes between field capacity and saturation are estimated using a linear function. Van Genuchten model: The well known van Genuchten (1980) model is: \\[\\begin{equation}\\theta(\\Psi) = \\theta_{res}+\\frac{\\theta_{sat}-\\theta_{res}}{\\left[1+ (\\alpha \\cdot \\Psi)^n \\right]^{1-1/n}}\\end{equation}\\] where \\(\\theta(\\psi)\\) is the water retention, \\(\\theta_{sat}\\) is the saturated water content, \\(\\theta_{res}\\) is the residual water content, \\(\\alpha\\) is related to the inverse of the air entry pressure, and \\(n\\) is a measure of the pore-size distribution. 2.1.3 Soil initialization Soil initialization is needed to estimate soil hydrological parameters for each soil layer \\(s\\) from their physical attributes. Initialization is done using function soil(), which adds the following information to the physical soil description: Symbol Units R Description \\(P_{macro, s}\\) % macro Percentage of macroporosity corresponding to each soil layers \\(\\gamma_{soil}\\) \\(mm \\cdot day^{-1}\\) Gsoil The maximum daily evaporation rate from soil \\(\\kappa_{soil}\\) Ksoil Extinction parameter to regulate the amount of water extracted from each soil layer when simulating evaporation from bare soil \\(\\theta_{sat, s}\\) \\(m^3 \\cdot m^{-3}\\) VG_theta_sat Volumetric moisture at saturation \\(\\theta_{res, s}\\) \\(m^3 \\cdot m^{-3}\\) VG_theta_res Residual volumetric moisture \\(n_s\\) VG_n Parameter of the Van Genuchten (1980) model \\(\\alpha_s\\) \\(MPa^{-1}\\) VG_alpha Parameter of the Van Genuchten (1980) model Macroporosity values are calculated using the equations given in Stolf et al. (2011), while \\(\\gamma_{soil}\\) and \\(\\kappa_{soil}\\) are derived from texture. Parameters of the van Genuchten model (including are estimated from the physical description of the soil using one of two pedotransfer functions (see help for soil()): Using the USDA texture classification and the average texture class parameters given by Carsel and Parrish (1988). Directly from the soil texture, organic matter and bulk density, using the pedotransfer functions in B. Tóth et al. (2015). Users can also edit the soil object manually, for example to provide specific parameters of the Van Genuchten retention curve calibrated from soil samples. 2.1.4 Water content and water table depth The water content (\\(V_s\\) in mm) of a soil layer \\(s\\) is calculated from its water potential and water retention curve using: \\[\\begin{equation} V_s(\\Psi) = d_s\\cdot ((100-P_{rocks,s})/100)\\cdot\\theta_{s}(\\Psi) \\end{equation}\\] where \\(d_s\\) is the depth of the soil layer (in mm) and \\(P_{rocks,s}\\) is the percentage of rock fragments. Besides this general formula, a number of contents are important to remember. Water holding capacity (\\(V_{fc, s}\\), in mm) of the soil layer \\(s\\) is defined as the volumetric water content at field capacity, i.e. -0.033 MPa: \\[\\begin{equation} V_{fc,s} = V_{s}(-0.033) = d_s\\cdot ((100-P_{rocks,s})/100)\\cdot\\theta_{fc,s} \\end{equation}\\] where \\(\\theta_{fc,s} = \\theta_s(-0.033)\\). Water content at saturation is calculated anagolously, but replacing \\(\\theta_{fc,s}\\) by \\(\\theta_{sat, s} = \\theta_s(0)\\). Water content at wilting point (-1.5 MPa) is calculated replacing \\(\\theta_{fc,s}\\) by \\(\\theta_{wp,s} = \\theta_s(-1.5)\\). The amount of extractable water is the difference between water content at field capacity and a the water content at a conventional minimum water potential, which can be set at wilting point or lower values (by default at -5 MPa in medfate). The depth of water table is the depth of saturated soil. In medfate, water table depth (\\(WT\\), in mm) equals soil depth when all soil layers are below field capacity. When some layers are between field capacity and saturation, water table depth is calculated as: \\[\\begin{equation} WT = \\sum_{s}{d_s \\cdot \\min\\left[1,(\\theta_{sat,s} - \\theta(\\Psi_s))/(\\theta_{sat,s}-\\theta_{fc,s})\\right]} \\end{equation}\\] 2.2 Vegetation description Representation of vegetation is not spatially-explicit in medfate (i.e. trees or shrubs do not have explicit coordinates within forest stands). However, differences in tree or shrub size (i.e. height) are explicitly taken into account. The taxonomic identity of plants is also considered, and parameter values need to be provided for each taxonomic entity (but the package could be used with functional groups). This representation is chosen so that package functions can be easily applied to forest plot data, for example from national forest inventories. Vegetation in the stand is described using a set of plant cohorts, in an object of class spwbInput. Each plant cohort \\(i\\) is primarly defined by its species identity (\\(SP_i\\); with R name [SP]). 2.2.1 Aboveground parameters The aboveground structure if each cohort is defined using a set attributes defined in the following table, where columns spwb and growth indicate whether attributes are required by functions spwb() and growth(), respectively: Symbol Units R Description spwb growth \\(H_i\\) \\(cm\\) H Total tree or shrub height Y Y \\(CR_i\\) CR Crown ratio (i.e. ratio between crown length and total height) Y Y \\(N\\) \\(ind · ha^{-1}\\) N The density of tree individuals N Y \\(DBH\\) \\(cm\\) DBH Tree diameter at breast height N Y \\(Cover\\) % Cover Shrub percent cover N Y \\(LAI^{live}_i\\) \\(m^2 \\cdot m^{-2}\\) LAI_live (Maximum) leaf area index Y Y \\(LAI^{dead}_i\\) \\(m^2 \\cdot m^{-2}\\) LAI_dead Dead leaf area index Y Y \\(LAI^{\\phi}_i\\) \\(m^2 \\cdot m^{-2}\\) LAI_expanded Current expanded leaf area index Y Y Height values refer to average height of individuals included in the cohort, and the same for crown ratio and \\(DBH\\). \\(LAI\\) variables refer to one-side leaf area of plants in the cohort per surface area of the stand. While plant height is relatively easy to measure, it is normally quite hard to estimate leaf area indices for stands and species. Package medfate provides some utilities to provide estimates crown ratio and \\(LAI\\) from forest inventory data (e.g. heights, DBH and density for measured trees), using allometric relationships calibrated for catalonia (see chapter 18). Vegetation characteristics stay constant during simulations using function spwb(), although the actual expanded leaf area and dead leaf area may vary is the species is winter deciduous. Function growth() can modify any of the vegetation attributes. 2.2.2 Belowground parameters The root system of each plant cohorts is described using the proportion of fine roots in each soil layer: \\(v_{i,s}\\) [V[i,s]]: The proportion of fine roots in each soil layer \\(s\\). The rooting system of each cohort \\(i\\) (i.e. the proportions \\(v_{i,s}\\)) can be defined assuming conic distribution of fine roots (see root_conicDistribution()). In this case, only rooting depth parameter is needed to determine fine root proportions. Alternatively, one can adopt the linear dose response model (Collins and Bras, 2007; Schenk and Jackson, 2002): \\[\\begin{equation} Y_i(z)=\\frac{1}{1+(z/Z_{50,i})^{c_i}} \\end{equation}\\] where \\(Y_i(z)\\) is the cumulative fraction of fine root mass located between surface and depth \\(z\\); \\(Z_{50,i}\\) is the depth above which 50% of the root mass is located; and \\(c_i\\) is a shape parameter related to \\(Z_{50,i}\\) and \\(Z_{95,i}\\) as \\(c_i = 2.94 / \\ln(Z_{50,i} / Z_{95,i})\\) (see root_ldrDistribution()). Figure 2.1: Examples of root density profile according to a conic distribution (left) and the linear dose response model (right). 2.3 Metereological input Weather input data must include variables calculated at the daily scale. Data should be arranged in a data frame with days in rows and variables in columns. The following table indicates the symbols, units, definitions and the variable name in R. Symbol Units R param Description \\(T_{mean}\\) \\(^{\\circ} \\mathrm{C}\\) MeanTemperature Mean temperature \\(T_{min}\\) \\(^{\\circ} \\mathrm{C}\\) MinTemperature Minimum temperature \\(T_{max}\\) \\(^{\\circ} \\mathrm{C}\\) MaxTemperature Maximum temperature \\(RH_{min}\\) % MinRelativeHumidity Minimum relative humidity \\(RH_{max}\\) % MaxRelativeHumidity Maximum relative humidity \\(P\\) \\(L \\cdot m^{-2} = mm\\) Precipitation Precipitation \\(PET\\) \\(L \\cdot m^{-2} = mm\\) PET Potential evapotranspiration, preferably calculated using Penman’s equation \\(Rad\\) \\(MJ \\cdot m^{-2}\\) Radiation Solar radiation after accounting for clouds \\(u\\) \\(m \\cdot s^{-1}\\) WindSpeed Wind speed Not all models require all weather variables, this will be indicated in the corresponding model chapters. For convenience, we recommend meteorological input to be generated using package meteoland (De Cáceres et al. 2018). 2.4 Control parameters Control parameters are a list of parameter values, initialized using function defaultControl(), that the user can modify to change the general behavior of model functions. Not all control parameters are relevant to all model functions Bibliography "]
]
