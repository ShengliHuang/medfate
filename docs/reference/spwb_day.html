<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Soil-plant water balance for a single day — spwb_day • medfate</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Soil-plant water balance for a single day — spwb_day" />

<meta property="og:description" content="Function spwb_day performs water balance for a single day." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/AdvancedWaterEnergyBalance.html">2. Advanced water and energy balance simulation</a>
    </li>
    <li>
      <a href="../articles/ForestGrowth.html">3. Forest growth simulation</a>
    </li>
    <li>
      <a href="../articles/PackageOverview.html">Package overview</a>
    </li>
    <li>
      <a href="../articles/SimpleWaterBalance.html">1. Introduction to water balance simulation</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Soil-plant water balance for a single day</h1>
    
    <div class="hidden name"><code>spwb_day.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Function <code>spwb_day</code> performs water balance for a single day.</p>
    
    </div>

    <pre class="usage"><span class='fu'>spwb_day</span>(<span class='no'>x</span>, <span class='no'>soil</span>, <span class='no'>date</span>, <span class='no'>tmin</span>, <span class='no'>tmax</span>, <span class='no'>rhmin</span>, <span class='no'>rhmax</span>, <span class='no'>rad</span>, <span class='no'>wind</span>,
        <span class='no'>latitude</span>, <span class='no'>elevation</span>, <span class='no'>slope</span>, <span class='no'>aspect</span>, <span class='no'>prec</span>, <span class='kw'>runon</span> <span class='kw'>=</span> <span class='fl'>0.0</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class <code><a href='forest2spwbInput.html'>spwbInput</a></code>.</p></td>
    </tr>
    <tr>
      <th>soil</th>
      <td><p>A list containing the description of the soil (see <code><a href='soil.html'>soil</a></code>).</p></td>
    </tr>
    <tr>
      <th>date</th>
      <td><p>Date as string "yyyy-mm-dd".</p></td>
    </tr>
    <tr>
      <th>tmin, tmax</th>
      <td><p>Minimum and maximum temperature (in degrees Celsius).</p></td>
    </tr>
    <tr>
      <th>rhmin, rhmax</th>
      <td><p>Minimum and maximum relative humidity (in percent).</p></td>
    </tr>
    <tr>
      <th>rad</th>
      <td><p>Solar radiation (in MJ/m2/day).</p></td>
    </tr>
    <tr>
      <th>wind</th>
      <td><p>Wind speed (in m/s).</p></td>
    </tr>
    <tr>
      <th>prec</th>
      <td><p>Precipitation (in mm).</p></td>
    </tr>
    <tr>
      <th>latitude</th>
      <td><p>Latitude (in degrees). Required when using the 'Sperry' transpiration mode.</p></td>
    </tr>
    <tr>
      <th>elevation, slope, aspect</th>
      <td><p>Elevation above sea level (in m), slope (in degrees) and aspect (in degrees from North). Required when using the 'Sperry' transpiration mode.</p></td>
    </tr>
    <tr>
      <th>runon</th>
      <td><p>Surface water amount running on the target area from upslope (in mm).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Detailed model description is available in the vignettes section. The model using 'Granier' transpiration mode is described in De Caceres et al. (2015). Simulations using the 'Sperry' transpiration mode are computationally much more expensive.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object (a list) of class <code>spwb_day</code> with the following elements:</p>
<ul>
<li><p><code>"cohorts"</code>: A data frame with cohort information, copied from <code><a href='forest2spwbInput.html'>spwbInput</a></code>.</p></li>
<li><p><code>"WaterBalance"</code>: A vector of water balance components (rain, snow, net rain, infiltration, ...) for the simulated day, equivalent to one row of 'WaterBalance' object given in <code><a href='spwb.html'>spwb</a></code>.</p></li>
<li><p><code>"Soil"</code>: A data frame with results for each soil layer:
    <ul>
<li><p><code>"SoilEvaporation"</code>: Water evaporated from the soil surface (in mm).</p></li>
<li><p><code>"HydraulicInput"</code>: Water entering each soil layer from other layers, transported via plant hydraulic network (in mm) (only for <code>transpirationMode = "Sperry"</code>).</p></li>
<li><p><code>"HydraulicOutput"</code>: Water leaving each soil layer (going to other layers or the transpiration stream) (in mm) (only for <code>transpirationMode = "Sperry"</code>).</p></li>
<li><p><code>"PlantExtraction"</code>: Water extracted by plants from each soil layer (in mm).</p></li>
<li><p><code>"psi"</code>: Soil water potential (in MPa).</p></li>
</ul></p></li>
<li><p><code>"EnergyBalance"</code>: When using the 'Sperry' transpiration mode, the model performs energy balance of the stand and 'EnergyBalance' is returned (see <code><a href='transpiration.html'>transp_transpirationSperry</a></code>).</p></li>
<li><p><code>"Plants"</code>: A data frame of results for each plant cohort (see <code><a href='transpiration.html'>transp_transpirationGranier</a></code> or <code><a href='transpiration.html'>transp_transpirationSperry</a></code>).</p></li>
<li><p><code>"RhizoPsi"</code>: Minimum water potential (in MPa) inside roots, after crossing rhizosphere, per cohort and soil layer.</p></li>
<li><p><code>"ExtractionInst"</code>: Water extracted by each plant cohort during each time step.</p></li>
<li><p><code>"PlantsInst"</code>: A list with instantaneous (per time step) results for each plant cohort (see <code><a href='transpiration.html'>transp_transpirationSperry</a></code>).</p></li>
</ul>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>De Cáceres M, Martínez-Vilalta J, Coll L, Llorens P, Casals P, Poyatos R, Pausas JG, Brotons L. (2015) Coupling a water balance model with forest inventory data to predict drought stress: the role of forest structural changes vs. climate changes. Agricultural and Forest Meteorology (doi:10.1016/j.agrformet.2015.06.012).</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Objects <code>x</code> and <code>soil</code> are modified during the simulation. Daily transpiration and photosynthesis values are stored in columns <code>Transpiration</code> and <code>Photosynthesis</code> of object <code>x</code>. Water content relative to field capacity (vector <code>W</code>) of <code>soil</code> is also modified.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='forest2spwbInput.html'>spwbInput</a></code>, <code><a href='spwb.html'>spwb</a></code>,  <code><a href='plot.spwb_day.html'>plot.spwb_day</a></code>,  
<code><a href='spwb_ldrOptimization.html'>spwb_ldrOptimization</a></code>, <code><a href='forest.html'>forest</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Load example daily meteorological data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>examplemeteo</span>)

<span class='co'>#Load example plot plant data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>exampleforest</span>)

<span class='co'>#Default species parameterization</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>SpParamsMED</span>)

<span class='co'>#Initialize control parameters</span>
<span class='no'>control</span> <span class='kw'>=</span> <span class='fu'><a href='defaultControl.html'>defaultControl</a></span>()

<span class='co'>#Initialize soil with default soil params (2 layers)</span>
<span class='no'>examplesoil</span> <span class='kw'>=</span> <span class='fu'><a href='soil.html'>soil</a></span>(<span class='fu'><a href='defaultSoilParams.html'>defaultSoilParams</a></span>(<span class='fl'>2</span>), <span class='kw'>W</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0.5</span>,<span class='fl'>0.5</span>))


<span class='co'>#Simulate one day only</span>
<span class='no'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='forest2spwbInput.html'>forest2spwbInput</a></span>(<span class='no'>exampleforest</span>,<span class='no'>examplesoil</span>, <span class='no'>SpParamsMED</span>, <span class='no'>control</span>)
<span class='no'>d</span> <span class='kw'>=</span> <span class='fl'>100</span>
<span class='no'>sd1</span><span class='kw'>&lt;-</span><span class='fu'>spwb_day</span>(<span class='no'>x1</span>, <span class='no'>examplesoil</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames</a></span>(<span class='no'>examplemeteo</span>)[<span class='no'>d</span>],
             <span class='no'>examplemeteo</span>$<span class='no'>MinTemperature</span>[<span class='no'>d</span>], <span class='no'>examplemeteo</span>$<span class='no'>MaxTemperature</span>[<span class='no'>d</span>],
             <span class='no'>examplemeteo</span>$<span class='no'>MinRelativeHumidity</span>[<span class='no'>d</span>], <span class='no'>examplemeteo</span>$<span class='no'>MaxRelativeHumidity</span>[<span class='no'>d</span>],
             <span class='no'>examplemeteo</span>$<span class='no'>Radiation</span>[<span class='no'>d</span>], <span class='no'>examplemeteo</span>$<span class='no'>WindSpeed</span>[<span class='no'>d</span>],
             <span class='kw'>latitude</span> <span class='kw'>=</span> <span class='fl'>41.82592</span>, <span class='kw'>elevation</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>slope</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>aspect</span><span class='kw'>=</span><span class='fl'>0</span>,
             <span class='kw'>prec</span> <span class='kw'>=</span> <span class='no'>examplemeteo</span>$<span class='no'>Precipitation</span>[<span class='no'>d</span>])

<span class='co'>#Initialize soil with default soil params (2 layers)</span>
<span class='no'>examplesoil2</span> <span class='kw'>=</span> <span class='fu'><a href='soil.html'>soil</a></span>(<span class='fu'><a href='defaultSoilParams.html'>defaultSoilParams</a></span>(<span class='fl'>2</span>))

<span class='co'>#Switch to 'Sperry' transpiration mode</span>
<span class='no'>control</span>$<span class='no'>transpirationMode</span><span class='kw'>=</span><span class='st'>"Sperry"</span>


<span class='co'>#Simulate one day only</span>
<span class='no'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='forest2spwbInput.html'>forest2spwbInput</a></span>(<span class='no'>exampleforest</span>,<span class='no'>examplesoil2</span>, <span class='no'>SpParamsMED</span>, <span class='no'>control</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Soil pedotransfer functions set to Van Genuchten ('VG').</span></div><div class='input'><span class='no'>d</span> <span class='kw'>=</span> <span class='fl'>100</span>
<span class='no'>sd2</span><span class='kw'>&lt;-</span><span class='fu'>spwb_day</span>(<span class='no'>x2</span>, <span class='no'>examplesoil2</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames</a></span>(<span class='no'>examplemeteo</span>)[<span class='no'>d</span>],
             <span class='no'>examplemeteo</span>$<span class='no'>MinTemperature</span>[<span class='no'>d</span>], <span class='no'>examplemeteo</span>$<span class='no'>MaxTemperature</span>[<span class='no'>d</span>],
             <span class='no'>examplemeteo</span>$<span class='no'>MinRelativeHumidity</span>[<span class='no'>d</span>], <span class='no'>examplemeteo</span>$<span class='no'>MaxRelativeHumidity</span>[<span class='no'>d</span>],
             <span class='no'>examplemeteo</span>$<span class='no'>Radiation</span>[<span class='no'>d</span>], <span class='no'>examplemeteo</span>$<span class='no'>WindSpeed</span>[<span class='no'>d</span>],
             <span class='kw'>latitude</span> <span class='kw'>=</span> <span class='fl'>41.82592</span>, <span class='kw'>elevation</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>slope</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>aspect</span><span class='kw'>=</span><span class='fl'>0</span>,
             <span class='kw'>prec</span> <span class='kw'>=</span> <span class='no'>examplemeteo</span>$<span class='no'>Precipitation</span>[<span class='no'>d</span>])

<span class='co'>#Plot plant transpiration (see function 'plot.swb.day()')</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>sd2</span>)</div><div class='img'><img src='spwb_day-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Miquel De Cáceres Ainsa, CTFC</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Miquel De Cáceres, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

