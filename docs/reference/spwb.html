<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Soil-plant water balance — spwb • medfate</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Soil-plant water balance — spwb" />

<meta property="og:description" content="Function spwb() is a water balance model that determines changes in soil moisture, soil water potentials and plant transpiration and drought stress at daily steps for a given forest stand during a period specified in the input climatic data. Additionally, the function also calculates plant net photosynthesis. Function pwb() performs plant water balance only (i.e. soil moisture dynamics is an input) at daily steps for a given forest stand during a period specified in the input climatic data. On both simulation functions transpiration and photosynthesis processes are conducted with different level of detail depending on the transpiration mode." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">medfate</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/AdvancedWaterEnergyBalance.html">Advanced water and energy balance simulation</a>
    </li>
    <li>
      <a href="../articles/BasicWaterBalance.html">Basic water balance simulation</a>
    </li>
    <li>
      <a href="../articles/ForestGrowth.html">Forest growth simulation</a>
    </li>
    <li>
      <a href="../articles/PackageOverview.html">Package overview</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Soil-plant water balance</h1>
    
    <div class="hidden name"><code>spwb.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Function <code>spwb()</code> is a water balance model that determines changes in soil moisture, soil water potentials and plant transpiration and drought stress at daily steps for a given forest stand during a period specified in the input climatic data. Additionally, the function also calculates plant net photosynthesis. Function <code>pwb()</code> performs plant water balance only (i.e. soil moisture dynamics is an input) at daily steps for a given forest stand during a period specified in the input climatic data. On both simulation functions transpiration and photosynthesis processes are conducted with different level of detail depending on the transpiration mode.</p>
    
    </div>

    <pre class="usage"><span class='fu'>spwb</span>(<span class='no'>x</span>, <span class='no'>soil</span>, <span class='no'>meteo</span>,  <span class='kw'>latitude</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>elevation</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>slope</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>aspect</span> <span class='kw'>=</span> <span class='fl'>NA</span>)
<span class='fu'>pwb</span>(<span class='no'>x</span>, <span class='no'>soil</span>, <span class='no'>meteo</span>, <span class='no'>W</span>, <span class='kw'>latitude</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>elevation</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>slope</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>aspect</span> <span class='kw'>=</span> <span class='fl'>NA</span>,
    <span class='kw'>canopyEvaporation</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></span>(<span class='fl'>0</span>),
    <span class='kw'>snowMelt</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></span>(<span class='fl'>0</span>),
    <span class='kw'>soilEvaporation</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></span>(<span class='fl'>0</span>))
<span class='fu'>spwb_resetInputs</span>(<span class='no'>x</span>, <span class='no'>soil</span>, <span class='kw'>from</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>day</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class <code><a href='forest2spwbInput.html'>spwbInput</a></code>.</p></td>
    </tr>
    <tr>
      <th>soil</th>
      <td><p>A list containing the description of the soil (see <code><a href='soil.html'>soil</a></code>).</p></td>
    </tr>
    <tr>
      <th>meteo</th>
      <td><p>A data frame with daily meteorological data series. Row names of the data frame should correspond to date strings with format "yyyy-mm-dd" (see <code><a href='https://www.rdocumentation.org/packages/base/topics/Dates'>Date</a></code>). When using the 'Granier' transpiration mode the following columns are required:</p><ul>
<li><p><code>MeanTemperature</code>: Mean temperature (in degrees Celsius).</p></li>
<li><p><code>Precipitation</code>: Precipitation (in mm).</p></li>
<li><p><code>Radiation</code>: Solar radiation (in MJ/m2/day), required only if <code>snowpack = TRUE</code>.</p></li>
<li><p><code>PET</code>: Potential evapotranspiration (in mm).</p></li>
</ul><p>When using the 'Sperry' transpiration mode the following columns are required:</p><ul>
<li><p><code>MeanTemperature</code>: Mean temperature (in degrees Celsius).</p></li>
<li><p><code>MinTemperature</code>: Minimum temperature (in degrees Celsius).</p></li>
<li><p><code>MaxTemperature</code>: Maximum temperature (in degrees Celsius).</p></li>
<li><p><code>MinRelativeHumidity</code>: Minimum relative humidity (in percent).</p></li>
<li><p><code>MaxRelativeHumidity</code>: Maximum relative humidity (in percent).</p></li>
<li><p><code>Precipitation</code>: Precipitation (in mm).</p></li>
<li><p><code>Radiation</code>: Solar radiation (in MJ/m2/day).</p></li>
<li><p><code>WindSpeed</code>: Wind speed (in m/s). If not available, this column can be left with <code>NA</code> values.</p></li>
</ul><p></p></td>
    </tr>
    <tr>
      <th>W</th>
      <td><p>A matrix with the same number of rows as <code>meteo</code> and as many columns as soil layers, containing the soil moisture of each layer as proportion of field capacity.</p></td>
    </tr>
    <tr>
      <th>latitude</th>
      <td><p>Latitude (in degrees). Required when using the 'Sperry' transpiration mode.</p></td>
    </tr>
    <tr>
      <th>elevation, slope, aspect</th>
      <td><p>Elevation above sea level (in m), slope (in degrees) and aspect (in degrees from North). Required when using the 'Sperry' transpiration mode. Elevation is also required for 'Granier' if snowpack dynamics are simulated.</p></td>
    </tr>
    <tr>
      <th>from</th>
      <td><p>An object of class <code>spwb</code> storing the results of a previous simulation, including values of state variables. If <code>from = NULL</code>, state variables are set to their defaults (i.e. soil moisture set to field capacity and cumulative growth degree days set to zero).</p></td>
    </tr>
    <tr>
      <th>day</th>
      <td><p>An integer with the day from which state variable values stored in <code>from</code> should be copied. If missing, values are copied from the first day of stored values.</p></td>
    </tr>
    <tr>
      <th>canopyEvaporation</th>
      <td><p>A vector of daily canopy evaporation (from interception) values (mm). The length should match the number of rows in <code>meteo</code>.</p></td>
    </tr>
    <tr>
      <th>soilEvaporation</th>
      <td><p>A vector of daily bare soil evaporation values (mm). The length should match the number of rows in <code>meteo</code>.</p></td>
    </tr>
    <tr>
      <th>snowMelt</th>
      <td><p>A vector of daily snow melt values (mm). The length should match the number of rows in <code>meteo</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Detailed model description is available in the vignettes section. The model using 'Granier' transpiration mode is illustrated by function <code><a href='transpiration.html'>transp_transpirationGranier</a></code> and described in De Caceres et al. (2015). Simulations using the 'Sperry' transpiration mode are computationally much more expensive and are illustrated by function <code><a href='transpiration.html'>transp_transpirationSperry</a></code>. Function <code>spwb_resetInputs()</code> allows resetting state variables in <code>x</code> and <code>soil</code> to their defaults, or to copy values of state variables from a previous <code>spwb()</code> simulation results stored in <code>from</code>.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Function <code>spwb</code> returns a list of class 'spwb' whereas Function <code>pwb</code> returns a list of class 'pwb'. There are many elements in common in these lists, so they are listed here together:</p><ul>
<li><p><code>"latitude"</code>: Latitude (in degrees) given as input.</p></li>
<li><p><code>"topography"</code>: Vector with elevation, slope and aspect given as input.</p></li>
<li><p><code>"spwbInput"</code>: An (unmodified) copy of the object <code>x</code> of class <code><a href='forest2spwbInput.html'>spwbInput</a></code> given as input  (note that <code>x</code> is modified by the simulation function).</p></li>
<li><p><code>"soilInput"</code>: An (unmodified) copy of the object <code>soil</code> of class <code><a href='soil.html'>soil</a></code> given as input (note that <code>soil</code> is modified by the simulation function).</p></li>
<li><p><code>"WaterBalance"</code>: A data frame where different variables (in columns) are given for each simulated day (in rows):</p><ul>
<li><p><code>"PET"</code>: Potential evapotranspiration (in mm).</p></li>
<li><p><code>"Precipitation"</code>: Input precipitation (in mm).</p></li>
<li><p><code>"Rain"</code>: Precipitation as rain (in mm).</p></li>
<li><p><code>"Snow"</code>: Precipitation as snow (in mm).</p></li>
<li><p><code>"NetRain"</code>: Net rain, after accounting for interception (in mm).</p></li>
<li><p><code>"Infiltration"</code>: The amount of water infiltrating into the soil (in mm).</p></li>
<li><p><code>"Runoff"</code>: The amount of water exported via surface runoff (in mm).</p></li>
<li><p><code>"DeepDrainage"</code>: The amount of water exported via deep drainage (in mm).</p></li>
<li><p><code>"Evapotranspiration"</code>: Evapotranspiration (in mm).</p></li>
<li><p><code>"SoilEvaporation"</code>: Bare soil evaporation (in mm).</p></li>
<li><p><code>"PlantExtraction"</code>: Amount of water extracted from soil by plants (in mm) (can only be diferent from transpiration for <code>transpirationMode = "Sperry"</code> when capacitance is considered).</p></li>
<li><p><code>"Transpiration"</code>: Plant transpiration (considering all soil layers) (in mm).</p></li>
<li><p><code>"HydraulicRedistribution"</code>: Water redistributed among soil layers, transported through the plant hydraulic network (only for <code>transpirationMode = "Sperry"</code>).</p></li>
</ul></li>
<li><p><code>"Soil"</code>: A data frame where different variables (in columns) are given for each simulated day (in rows):</p><ul>
<li><p><code>"W.1"</code>, <code>...</code>, <code>"W.k"</code>: Relative soil moisture content (relative to field capacity) in each soil layer.</p></li>
<li><p><code>"ML.1"</code>, <code>...</code>, <code>"ML.k"</code>: Soil water volume in each soil layer (in L/m2).</p></li>
<li><p><code>"MLTot"</code>: Total soil water volume (in L/m2).</p></li>
<li><p><code>"SWE"</code>: Snow water equivalent (mm) of the snow pack.</p></li>
<li><p><code>"PlantExt.1"</code>, <code>...</code>, <code>"PlantExt.k"</code>: Plant extraction from each soil layer (in mm).</p></li>
<li><p><code>"HydraulicInput.1"</code>, <code>...</code>, <code>"HydraulicInput.k"</code>: Water that entered the layer coming from other layers and transported via the plant hydraulic network (in mm) (only for <code>transpirationMode = "Sperry"</code>).</p></li>
<li><p><code>"psi.1"</code>, <code>...</code>, <code>"psi.k"</code>: Soil water potential in each soil layer (in MPa).</p></li>
</ul></li>
<li><p><code>"Stand"</code>: A data frame where different variables (in columns) are given for each simulated day (in rows):</p>      
<p></p><ul>
<li><p><code>"GDD"</code>: Cumulative growth degree days.</p></li>
<li><p><code>"LAIcell"</code>: LAI of the stand (accounting for leaf phenology) (in m2/m2).</p></li>
<li><p><code>"LAIcelldead"</code>: LAI of the stand corresponding to dead leaves (in m2/m2).</p></li>
<li><p><code>"Cm"</code>: Water retention capacity of the canopy (in mm) (accounting for leaf phenology).</p></li>
<li><p><code>"LgroundPAR"</code>: The proportion of PAR that reaches the ground (accounting for leaf phenology).</p></li>
<li><p><code>"LgroundSWR"</code>: The proportion of SWR that reaches the ground (accounting for leaf phenology).</p></li>
</ul></li>
<li><p><code>"PlantLAI"</code>: A data frame with the daily leaf area index for each plant cohort. Days are in rows and plant cohorts are in columns.</p></li>
<li><p><code>"PlantAbsorbedSWRFraction"</code>: A data frame with the fraction of SWR absorbed by each plant cohort. Days are in rows and plant cohorts are in columns.</p></li>
<li><p><code>"PlantTranspiration"</code>: A data frame with the amount of daily transpiration (in mm) for each plant cohort. Days are in rows and plant cohorts are in columns.</p></li>
<li><p><code>"PlantPhotosynthesis"</code>: A data frame with the amount of daily net photosynthesis (in g C·m-2) for each plant cohort. Days are in rows and plant cohorts are in columns.</p></li>
<li><p><code>"PlantPsi"</code>: A data frame with the average daily water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"PlantStress"</code>: A data frame with the amount of daily stress [0-1] suffered by each plant cohort (relative whole-plant conductance). Days are in rows and plant cohorts are in columns.</p></li>
<li><p><code>"subdaily"</code>: A list of objects of class <code><a href='spwb_day.html'>spwb_day</a></code>, one per day simulated (only if required in <code>control</code> parameters, see <code><a href='defaultControl.html'>defaultControl</a></code>).</p></li>
</ul><p>If <code>transpirationMode=="Sperry"</code> the list also includes the following elements:</p><ul>
<li><p><code>"PlantAbsorbedSWR"</code>: A data frame with the daily SWR absorbed by each plant cohort. Days are in rows and plant cohorts are in columns.</p></li>
<li><p><code>"PlantAbsorbedLWR"</code>: A data frame with the daily LWR absorbed by each plant cohort. Days are in rows and plant cohorts are in columns.</p></li>
<li><p><code>"dEdP"</code>: A data frame with mean daily values of soil-plant conductance (derivative of the supply function) for each plant cohort. Days are in rows and plant cohorts in columns.</p></li>
<li><p><code>"EnergyBalance"</code>: A data frame with the daily values of energy balance components for the soil and the canopy.</p></li>
<li><p><code>"Temperature"</code>: A data frame with the daily values of minimum/mean/maximum temperatures for the atmosphere (input), canopy and soil.</p></li>
<li><p><code>"LeafPsiMin"</code>: A data frame with the minimum (midday) daily (average) leaf water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"LeafPsiMax"</code>: A data frame with the maximum (predawn) daily (average) leaf water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"LeafPsiMin_SL"</code>: A data frame with the minimum (midday) daily sunlit leaf water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"LeafPsiMax_SL"</code>: A data frame with the maximum (predawn) daily sunlit leaf water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"LeafPsiMin_SH"</code>: A data frame with the minimum (midday) daily shade leaf water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"LeafPsiMax_SH"</code>: A data frame with the maximum (predawn) daily shade leaf water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"LeafRWC"</code>: A data frame with the average daily leaf relative water content of each plant (in percent). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"StemPsi"</code>: A data frame with the minimum daily stem water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"StemPLC"</code>: A data frame with the average daily proportion of stem conductance loss of each plant ([0-1]). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"StemRWC"</code>: A data frame with the average daily stem relative water content of each plant (in percent). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"RootPsi"</code>: A data frame with the minimum daily root water potential of each plant (in MPa). Days are in rows and plant cohorts are in columns. Columns in this data frame correspond to the elements in 'SP'.</p></li>
<li><p><code>"RhizoPsi"</code>: A list of data frames (one per plant cohort) with the minimum daily root water potential of each plant (in MPa). In each data frame, days are in rows and layers are in columns.</p></li>
</ul>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>De Cáceres M, Martínez-Vilalta J, Coll L, Llorens P, Casals P, Poyatos R, Pausas JG, Brotons L. (2015) Coupling a water balance model with forest inventory data to predict drought stress: the role of forest structural changes vs. climate changes. Agricultural and Forest Meteorology 213: 77-90 (doi:10.1016/j.agrformet.2015.06.012).</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>State variables stored in objects <code>x</code> and <code>soil</code> are modified during the simulation. Use function <code>spwb_resetInputs()</code> to reset state variables to defaults. Daily transpiration and photosynthesis values are stored in columns <code>Transpiration</code> and <code>Photosynthesis</code> of object <code>x</code>. Water content relative to field capacity (vector <code>W</code>) of <code>soil</code> is also modified.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='forest2spwbInput.html'>spwbInput</a></code>, <code><a href='spwb_day.html'>spwb_day</a></code>, <code><a href='plot.spwb.html'>plot.spwb</a></code>,  
<code><a href='spwb_ldrOptimization.html'>spwb_ldrOptimization</a></code>, <code><a href='forest.html'>forest</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#Load example daily meteorological data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>examplemeteo</span>)

<span class='co'>#Load example plot plant data</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>exampleforest</span>)

<span class='co'>#Default species parameterization</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/data'>data</a></span>(<span class='no'>SpParamsMED</span>)

<span class='co'>#Initialize soil with default soil params (2 layers)</span>
<span class='no'>examplesoil</span> <span class='kw'>=</span> <span class='fu'><a href='soil.html'>soil</a></span>(<span class='fu'><a href='defaultSoilParams.html'>defaultSoilParams</a></span>(<span class='fl'>2</span>))

<span class='co'>#Initialize control parameters</span>
<span class='no'>control</span> <span class='kw'>=</span> <span class='fu'><a href='defaultControl.html'>defaultControl</a></span>()

<span class='co'>#Initialize input</span>
<span class='no'>x1</span> <span class='kw'>=</span> <span class='fu'><a href='forest2spwbInput.html'>forest2spwbInput</a></span>(<span class='no'>exampleforest</span>,<span class='no'>examplesoil</span>, <span class='no'>SpParamsMED</span>, <span class='no'>control</span>)

<span class='co'>#Call simulation function</span>
<span class='no'>S1</span><span class='kw'>&lt;-</span><span class='fu'>spwb</span>(<span class='no'>x1</span>, <span class='no'>examplesoil</span>, <span class='no'>examplemeteo</span>, <span class='kw'>elevation</span> <span class='kw'>=</span> <span class='fl'>100</span>)</div><div class='output co'>#&gt; Initial soil water content (mm): 200.239
#&gt; Performing daily simulations .....................................done.
#&gt; Final soil water content (mm): 180.113
#&gt; Change in soil water content (mm): -20.1257
#&gt; Water balance result (mm): -20.1257
#&gt; Water balance components:
#&gt;   Precipitation (mm) 513
#&gt;   Rain (mm) 462 Snow (mm) 51
#&gt;   Interception (mm) 86 Net rainfall (mm) 376
#&gt;   Infiltration (mm) 419 Runoff (mm) 8 Deep drainage (mm) 103
#&gt;   Soil evaporation (mm) 39 Transpiration (mm) 297</div><div class='input'>
<span class='co'>#Plot results</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/graphics/topics/plot'>plot</a></span>(<span class='no'>S1</span>)</div><div class='img'><img src='spwb-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#Monthly summary (averages) of soil water balance</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/summary'>summary</a></span>(<span class='no'>S1</span>, <span class='kw'>freq</span><span class='kw'>=</span><span class='st'>"months"</span>,<span class='kw'>FUN</span><span class='kw'>=</span><span class='no'>mean</span>, <span class='kw'>output</span><span class='kw'>=</span><span class='st'>"Soil"</span>)</div><div class='output co'>#&gt;                  W.1       W.2     ML.1      ML.2    MLTot  WTD        SWE
#&gt; 2001-01-01 0.9922356 0.9947366 72.24882 126.75412 199.0029 1000 1.65056874
#&gt; 2001-02-01 0.9711613 0.9500296 70.71431 121.05734 191.7716 1000 0.27480347
#&gt; 2001-03-01 0.9747463 0.9661769 70.97535 123.11491 194.0903 1000 0.01762496
#&gt; 2001-04-01 0.9538158 0.8615827 69.45131 109.78701 179.2383 1000 0.57895858
#&gt; 2001-05-01 0.9493763 0.8599847 69.12805 109.58338 178.7114 1000 0.00000000
#&gt; 2001-06-01 0.8333673 0.6366546 60.68096  81.12560 141.8066 1000 0.00000000
#&gt; 2001-07-01 0.9583558 0.6870262 69.78189  87.54418 157.3261 1000 0.00000000
#&gt; 2001-08-01 0.9633368 0.7631771 70.14458  97.24769 167.3923 1000 0.00000000
#&gt; 2001-09-01 0.9643429 0.8029288 70.21783 102.31305 172.5309 1000 0.00000000
#&gt; 2001-10-01 0.9768679 0.8261857 71.12983 105.27656 176.4064 1000 0.00000000
#&gt; 2001-11-01 0.9717403 0.9225943 70.75647 117.56141 188.3179 1000 2.59388333
#&gt; 2001-12-01 0.9402455 0.9292045 68.46320 118.40370 186.8669 1000 0.00000000
#&gt;            PlantExt.1 PlantExt.2       psi.1       psi.2
#&gt; 2001-01-01 0.06686311  0.2356511 -0.03444909 -0.03401859
#&gt; 2001-02-01 0.13947418  0.4915593 -0.03863988 -0.04416217
#&gt; 2001-03-01 0.14492370  0.5107660 -0.03755349 -0.03965679
#&gt; 2001-04-01 0.18493869  0.6517837 -0.04222177 -0.07286244
#&gt; 2001-05-01 0.21828994  0.7693124 -0.04427942 -0.07676995
#&gt; 2001-06-01 0.31120215  1.0879804 -0.08631691 -0.42670990
#&gt; 2001-07-01 0.26268290  0.9124204 -0.04198163 -0.38689128
#&gt; 2001-08-01 0.26538933  0.9351735 -0.04001082 -0.13920740
#&gt; 2001-09-01 0.20828518  0.7340370 -0.04002550 -0.10297327
#&gt; 2001-10-01 0.14940358  0.5265229 -0.03738415 -0.09492900
#&gt; 2001-11-01 0.10791619  0.3803352 -0.03838629 -0.05214590
#&gt; 2001-12-01 0.10093362  0.3557280 -0.04567248 -0.04910614</div><div class='input'>

</div><span class='co'># NOT RUN {</span>
<span class='co'>#Initialize soil with default soil params (2 layers)</span>
<span class='no'>examplesoil2</span> <span class='kw'>=</span> <span class='fu'><a href='soil.html'>soil</a></span>(<span class='fu'><a href='defaultSoilParams.html'>defaultSoilParams</a></span>(<span class='fl'>2</span>))

<span class='co'>#Switch to 'Sperry' transpiration mode</span>
<span class='no'>control</span>$<span class='no'>transpirationMode</span><span class='kw'>=</span><span class='st'>"Sperry"</span>

<span class='co'>#Initialize input</span>
<span class='no'>x2</span> <span class='kw'>=</span> <span class='fu'><a href='forest2spwbInput.html'>forest2spwbInput</a></span>(<span class='no'>exampleforest</span>,<span class='no'>examplesoil2</span>, <span class='no'>SpParamsMED</span>, <span class='no'>control</span>)

<span class='co'>#Call simulation function (11 days)</span>
<span class='no'>d</span> <span class='kw'>=</span> <span class='fl'>100</span>:<span class='fl'>110</span>
<span class='no'>S2</span><span class='kw'>&lt;-</span><span class='fu'>spwb</span>(<span class='no'>x2</span>, <span class='no'>examplesoil2</span>, <span class='no'>examplemeteo</span>[<span class='no'>d</span>,], <span class='kw'>latitude</span> <span class='kw'>=</span> <span class='fl'>41.82592</span>, <span class='kw'>elevation</span> <span class='kw'>=</span> <span class='fl'>100</span>)

<span class='co'># Run the model with 'Sperry' transpiration mode using the water balance of </span>
<span class='co'># simulated with the 'Granier' model</span>
<span class='no'>P2</span><span class='kw'>&lt;-</span><span class='fu'>pwb</span>(<span class='no'>x2</span>, <span class='no'>examplesoil2</span>, <span class='no'>examplemeteo</span>[<span class='no'>d</span>,], <span class='kw'>latitude</span> <span class='kw'>=</span> <span class='fl'>41.82592</span>, <span class='kw'>elevation</span> <span class='kw'>=</span> <span class='fl'>100</span>,
        <span class='kw'>W</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(<span class='no'>S1</span>$<span class='no'>Soil</span>[<span class='no'>d</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"W.1"</span>, <span class='st'>"W.2"</span>)]),
        <span class='kw'>canopyEvaporation</span> <span class='kw'>=</span> <span class='no'>S1</span>$<span class='no'>WaterBalance</span>$<span class='no'>Interception</span>[<span class='no'>d</span>],
        <span class='kw'>snowMelt</span> <span class='kw'>=</span> <span class='no'>S1</span>$<span class='no'>WaterBalance</span>$<span class='no'>Snowmelt</span>[<span class='no'>d</span>],
        <span class='kw'>soilEvaporation</span> <span class='kw'>=</span> <span class='no'>S1</span>$<span class='no'>WaterBalance</span>$<span class='no'>SoilEvaporation</span>[<span class='no'>d</span>])
<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Miquel De Cáceres Ainsa, CTFC</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Miquel De Cáceres, Víctor Granda, Antoine Cabon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

